AFTER : test_long_consumer2
BEFORE : test_single_ccnd_teardown test_twohop_ccnd_teardown
# ccnd 0 is already running and loaded with some data

WithCCND 1 ccnd &
WithCCND 2 ccnd &
WithCCND 3 ccnd &

sleep 1 2>/dev/null

Linkup () {
  D=$1
  R=$2
  shift 2
  WithCCND $D udplink -h localhost -r $((CCN_LOCAL_PORT_BASE+$R)) -l $((9100 + $D + 10 * $R)) "$@" &
}

# 0 --- 1 --- 2
#       |
#       3

Linkup 1 0
Linkup 2 1
Linkup 3 1 -dd

# hack to get second direction
WithCCND 2 ccnget ccn:/ |:
WithCCND 3 ccnget ccn:/ |:

WithCCND 2 RunTest test_long_consumer
#test 1 -eq `WithCCND 3 ccndumpnames | wc -l` || Fail spur ccnd should only have one item
